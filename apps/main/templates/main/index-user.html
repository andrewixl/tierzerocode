{% extends 'main/base.html' %}
{% load static %}
  {% block content %}
			<main class="content">
				<div class="container-fluid p-0">

					<div class="row mb-2 mb-xl-3">
						<div class="col-auto d-none d-sm-block">
							<h3><strong>User Analytics</strong> Dashboard</h3>
						</div>
					</div>
					<div class="row">
						<div class="col-xl-12 col-xxl-12 d-flex">
							<div class="w-100">
								<div class="row">
									<div class="col-sm-2">
										<a href="/users/master-list/"><div class="card">
											<div class="card-body">
												<div class="row">
													<div class="col mt-0">
														<h5 class="card-title">All Users</h5>
													</div>
													<div class="col-auto">
														<div class="stat text-primary">
															<i class="align-middle" data-feather="list"></i>
														</div>
													</div>
												</div>
												<h1 class="mt-1 mb-3">{{ count_total_users }} Users</h1>
											</div>
										</div></a>
									</div>
									{% for persona in personas %}
									{% if persona.persona_name != 'DUPLICATE' and persona.persona_name != 'Unknown' %}
									<div class="col-sm-2">
										<a href="/user-dashboard/{{ persona.id }}"><div class="card">
											<div class="card-body">
												<div class="row">
													<div class="col mt-0">
														<h5 class="card-title">{{ persona.persona_name }}</h5>
													</div>
													<div class="col-auto">
														<div class="stat text-primary">
															<i class="align-middle" data-feather="list"></i>
														</div>
													</div>
												</div>
												<h1 class="mt-1 mb-3">{{ persona.user_count }} Users</h1>
											</div>
										</div></a>
									</div>
									{% endif %}
									{% endfor %}
									<div class="col-sm-2">
										<a href="/user-dashboard/duplicate-persona"><div class="card">
											<div class="card-body">
												<div class="row">
													<div class="col mt-0">
														<h5 class="card-title">Duplicate Persona</h5>
													</div>
													<div class="col-auto">
														<div class="stat text-primary">
															<i class="align-middle" data-feather="list"></i>
														</div>
													</div>
												</div>
												<h1 class="mt-1 mb-3">{{ count_duplicate_persona }} Users</h1>
											</div>
										</div></a>
									</div>
									<div class="col-sm-2">
										<a href="/user-dashboard/unknown-persona"><div class="card">
											<div class="card-body">
												<div class="row">
													<div class="col mt-0">
														<h5 class="card-title">Unknown Persona</h5>
													</div>
													<div class="col-auto">
														<div class="stat text-primary">
															<i class="align-middle" data-feather="list"></i>
														</div>
													</div>
												</div>
												<h1 class="mt-1 mb-3">{{ count_unknown_persona }} Users</h1>
											</div>
										</div></a>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-12 col-md-6 col-xxl-3 d-flex order-1 order-xxl-3">
							<div class="card flex-fill w-100">
								<div class="card-header">
									<h5 class="card-title mb-0">MFA Method Adoption</h5>
								</div>
								<div class="card-body d-flex">
									<div class="align-self-center w-100">
										<div class="py-3">
											<div class="chart chart-xs">
												<canvas id="adoption-auth-pie"></canvas>
											</div>
										</div>

										<table class="table mb-0">
											<tbody>
												<tr>
													<td><i class="fas fa-circle text-primary fa-fw"></i> Windows Hello for Business</td>
													<td class="text-end">{{auth_method_adoption_data.0}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-secondary fa-fw"></i> Passkey Device</td>
													<td class="text-end">{{auth_method_adoption_data.1}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-success fa-fw"></i> Passkey Authenticator</td>
													<td class="text-end">{{auth_method_adoption_data.2}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-danger fa-fw"></i> MS Authenticator Passwordless</td>
													<td class="text-end">{{auth_method_adoption_data.3}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-warning fa-fw"></i> MS Authenticator Push</td>
													<td class="text-end">{{auth_method_adoption_data.4}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-info fa-fw"></i> Software OTP</td>
													<td class="text-end">{{auth_method_adoption_data.5}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-light fa-fw"></i> Mobile Phone</td>
													<td class="text-end">{{auth_method_adoption_data.6}}</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
						<div class="col-12 col-md-6 col-xxl-3 d-flex order-1 order-xxl-3">
							<div class="card flex-fill w-100">
								<div class="card-header">
									<h5 class="card-title mb-0">Highest Auth Method Adoption</h5>
								</div>
								<div class="card-body d-flex">
									<div class="align-self-center w-100">
										<div class="py-3">
											<div class="chart chart-xs">
												<canvas id="highest-auth-pie"></canvas>
											</div>
										</div>

										<table class="table mb-0">
											<tbody>
												<tr>
													<td><i class="fas fa-circle text-primary fa-fw"></i> Phishing Resistant</td>
													<td class="text-end">{{auth_method_data.0}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-secondary fa-fw"></i> Passwordless</td>
													<td class="text-end">{{auth_method_data.1}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-success fa-fw"></i> MFA</td>
													<td class="text-end">{{auth_method_data.2}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-danger fa-fw"></i> Deprecated</td>
													<td class="text-end">{{auth_method_data.3}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-warning fa-fw"></i> None</td>
													<td class="text-end">{{auth_method_data.4}}</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
						<div class="col-12 col-md-6 col-xxl-3 d-flex order-1 order-xxl-3">
							<div class="card flex-fill w-100">
								<div class="card-header">
									<h5 class="card-title mb-0">Lowest Auth Methods</h5>
								</div>
								<div class="card-body d-flex">
									<div class="align-self-center w-100">
										<div class="py-3">
											<div class="chart chart-xs">
												<canvas id="lowest-auth-pie"></canvas>
											</div>
										</div>

										<table class="table mb-0">
											<tbody>
												<tr>
													<td><i class="fas fa-circle text-primary fa-fw"></i> {{auth_method_low_labels.0}}</td>
													<td class="text-end">{{auth_method_low_data.0}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-secondary fa-fw"></i> {{auth_method_low_labels.1}}</td>
													<td class="text-end">{{auth_method_low_data.1}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-success fa-fw"></i> {{auth_method_low_labels.2}}</td>
													<td class="text-end">{{auth_method_low_data.2}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-danger fa-fw"></i> {{auth_method_low_labels.3}}</td>
													<td class="text-end">{{auth_method_low_data.3}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-warning fa-fw"></i> {{auth_method_low_labels.4}}</td>
													<td class="text-end">{{auth_method_low_data.4}}</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
						<!-- <div class="col-12 col-md-6 col-xxl-3 d-flex order-1 order-xxl-3">
							<div class="card flex-fill w-100">
								<div class="card-header">
									<h5 class="card-title mb-0">Full Passwordless Enrollment Users</h5>
								</div>
								<div class="card-body d-flex">
									<div class="align-self-center w-100">
										<div class="py-3">
											<div class="chart chart-xs">
												<canvas id="full-passwordless-pie"></canvas>
											</div>
										</div>

										<table class="table mb-0">
											<tbody>
												<tr>
													<td><i class="fas fa-circle text-success fa-fw"></i> Full Passwordless</td>
													<td class="text-end">{{count_passwordless_data.0}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-danger fa-fw"></i> Non-Passwordless</td>
													<td class="text-end">{{count_passwordless_data.1}}</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div> -->
						<div class="col-12 col-md-6 col-xxl-3 d-flex order-1 order-xxl-3">
							<div class="card flex-fill w-100">
								<div class="card-header">
									<h5 class="card-title mb-0">Passwordless Capable Users</h5>
								</div>
								<div class="card-body d-flex">
									<div class="align-self-center w-100">
										<div class="py-3">
											<div class="chart chart-xs">
												<canvas id="full-passwordless-capable-pie"></canvas>
											</div>
										</div>

										<table class="table mb-0">
											<tbody>
												<tr>
													<td><i class="fas fa-circle text-success fa-fw"></i> Passwordless Capable</td>
													<td class="text-end">{{count_passwordless_capable_data.0}}</td>
												</tr>
												<tr>
													<td><i class="fas fa-circle text-danger fa-fw"></i> Non-Passwordless Capable</td>
													<td class="text-end">{{count_passwordless_capable_data.1}}</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</main>
			<script>
				document.addEventListener("DOMContentLoaded", function() {
					// Pie chart
					new Chart(document.getElementById("adoption-auth-pie"), {
						type: "pie",
						data: {
							labels: {{ auth_method_adoption_labels|safe }},
							datasets: [{ 
								data: {{ auth_method_adoption_data|safe }},
								backgroundColor: [
									window.theme.primary,
									window.theme.secondary,
									window.theme.success,
									window.theme.danger,
									window.theme.warning,
									window.theme.info,
									window.theme.light
								],
								borderWidth: 5,
								borderColor: window.theme.white
							}]
						},
						options: {
							responsive: !window.MSInputMethodContext,
							maintainAspectRatio: false,
							legend: {
								display: false
							},
							cutoutPercentage: 70
						}
					});
				});
			</script>
			<script>
				document.addEventListener("DOMContentLoaded", function() {
					// Pie chart
					new Chart(document.getElementById("highest-auth-pie"), {
						type: "pie",
						data: {
							labels: {{ auth_method_labels|safe }},
							datasets: [{ 
								data: {{ auth_method_data|safe }},
								backgroundColor: [
									window.theme.primary,
									window.theme.secondary,
									window.theme.success,
									window.theme.danger,
									window.theme.warning,
								],
								borderWidth: 5,
								borderColor: window.theme.white
							}]
						},
						options: {
							responsive: !window.MSInputMethodContext,
							maintainAspectRatio: false,
							legend: {
								display: false
							},
							cutoutPercentage: 70
						}
					});
				});
			</script>
			<script>
				document.addEventListener("DOMContentLoaded", function() {
					// Pie chart
					new Chart(document.getElementById("full-passwordless-capable-pie"), {
						type: "pie",
						data: {
							labels: {{ count_passwordless_capable_labels|safe }},
							datasets: [{ 
								data: {{ count_passwordless_capable_data|safe }},
								backgroundColor: [
									window.theme.success,
									window.theme.danger,
								],
								borderWidth: 5,
								borderColor: window.theme.white
							}]
						},
						options: {
							responsive: !window.MSInputMethodContext,
							maintainAspectRatio: false,
							legend: {
								display: false
							},
							cutoutPercentage: 70
						}
					});
				});
			</script>
			<script>
				document.addEventListener("DOMContentLoaded", function() {
					// Pie chart
					new Chart(document.getElementById("lowest-auth-pie"), {
						type: "pie",
						data: {
							labels: {{ auth_method_low_labels|safe }},
							datasets: [{ 
								data: {{ auth_method_low_data|safe }},
								backgroundColor: [
									window.theme.primary,
									window.theme.secondary,
									window.theme.success,
									window.theme.danger,
									window.theme.warning,
								],
								borderWidth: 5,
								borderColor: window.theme.white
							}]
						},
						options: {
							responsive: !window.MSInputMethodContext,
							maintainAspectRatio: false,
							legend: {
								display: false
							},
							cutoutPercentage: 70
						}
					});
				});
			</script>
{% endblock %}